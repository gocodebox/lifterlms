!function(i){window.llms=window.llms||{};window.llms.admin_tables=new function(){this.$tables=null,this.init=function(){var t=this;t.$tables=i(".llms-gb-table, body.post-type-llms_order .wp-list-table"),t.$tables.length&&t.bind()},this.bind=function(){var s=this;this.$tables.each(function(){var e,n,r,a=i(this);a.on("click",'button[name="llms-table-paging"]',function(t){t.preventDefault(),s.change_page(a,i(this))}),a.on("click",'button[name="llms-table-export"]',function(t){t.preventDefault(),s.export(a,i(this))}),a.parent().find('.tablenav button[name="llms-table-export"]').on("click",function(t){t.preventDefault(),console.log("clicked"),s.export(a,i(this))}),a.on("click","a.llms-sortable",function(t){t.preventDefault(),s.change_order(a,i(this))}),a.parent().find(".llms-table-filters").on("change","select.llms-table-filter",function(t){s.change_filter(a,i(this))}),a.parent().find(".llms-table-search").on("keyup","input",(e=function(t){switch(t.keyCode){case 37:case 38:case 39:case 40:return;default:s.search(a,i(this))}},n=250,r=null,function(){var t=this,a=arguments;window.clearTimeout(r),r=window.setTimeout(function(){e.apply(t,a)},n)}))})},this.change_order=function(t,a){this.reload(t,{order:a.attr("data-order"),orderby:a.attr("data-orderby"),page:1})},this.change_filter=function(t,a){this.reload(t,{filter:a.val(),filterby:a.attr("name"),page:1})},this.change_page=function(t,a){this.reload(t,{order:this.get_args(t,"order"),orderby:this.get_args(t,"orderby"),page:a.attr("data-page")})},this.export=function(t,e,a){var n=this,r=t.parent().find(".llms-table-export .llms-table-export-msg"),s=t.parent().find(".llms-table-export .llms-table-progress");function l(){LLMS.Spinner.stop(e,"small"),e.removeAttr("disabled")}$data_args=(t.attr("data-handler")?($data_handler=t.attr("data-handler"),t):($data_handler=e.attr("data-handler"),e)).attr("data-args"),LLMS.Ajax.call({data:i.extend({action:"export_admin_table",handler:$data_handler,filename:a},JSON.parse($data_args)),beforeSend:function(){e.attr("disabled")||(e.attr("disabled","disabled"),LLMS.Spinner.start(e,"small"))},error:function(t,a,e){var n=LLMS.l10n.translate("An error was encountered generating the export");l(),s.hide(),r.html('<span class="llms-error">'+n+": "+e+"</span>"),console.error(t)},success:function(a){!a.success&&a.message?(l(),s.hide(),r.html('<span class="llms-error">'+a.message+"</span>")):a.success&&a.data&&a.data.progress&&(r.html(""),s.is("visible")||100===a.data.progress||s.css("display","inline-block"),s.find(".llms-table-progress-text").text(a.data.progress+"%"),s.find(".llms-table-progress-inner").css("width",a.data.progress+"%"),100!==a.data.progress?n.export(t,e,a.data.filename):setTimeout(function(){var t="llms-dl-export";i("#"+t).remove(),i("<a />",{id:t,href:a.data.url,style:"display: hidden;",download:""}).appendTo("body"),i("#"+t)[0].click(),l(),s.hide()},1e3))}})},this.get_args=function(t,a){t=JSON.parse(t.attr("data-args"));return a?t[a]||!1:t},this.reload=function(a,t){t=i.extend({action:"get_admin_table_data",handler:a.attr("data-handler")},JSON.parse(a.attr("data-args")),t),LLMS.Ajax.call({data:t,beforeSend:function(){LLMS.Spinner.start(a.closest(".llms-table-wrap"))},success:function(t){LLMS.Spinner.stop(a.closest(".llms-table-wrap")),t.success&&(a.attr("data-args",t.data.args),a.find("thead").replaceWith(t.data.thead),a.find("tbody").replaceWith(t.data.tbody),a.find("tfoot").replaceWith(t.data.tfoot))}})},this.search=function(t,a){var e=a.val();(0===(len=e.length)||3<=len)&&this.reload(t,{page:1,search:a.val()})},this.init()}}(jQuery);
//# sourceMappingURL=../maps/js/llms-admin-tables.min.js.map
