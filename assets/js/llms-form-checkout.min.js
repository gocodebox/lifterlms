!function(l){window.llms=window.llms||{},window.llms.checkout=new function(){var m=[],s=[];return this.$checkout_form=l("#llms-product-purchase-form"),this.$confirm_form=l("#llms-product-purchase-confirm-form"),this.$form_sections=!1,this.form_action=!1,this.init=function(){var t=this;this.$checkout_form.length?(this.form_action="checkout",this.$form_sections=this.$checkout_form.find(".llms-checkout-section"),this.$checkout_form.on("submit",this,this.submit),l(".llms-password-strength-meter").length&&this.add_before_submit_event({data:LLMS.PasswordStrength,handler:LLMS.PasswordStrength.checkout}),this.bind_login(),this.bind_coupon(),this.bind_gateways()):this.$confirm_form.length&&(this.form_action="confirm",this.$form_sections=this.$confirm_form.find(".llms-checkout-section"),this.$confirm_form.on("submit",function(){t.processing("start")}))},this.add_before_submit_event=function(t){t.handler&&"function"==typeof t.handler&&(t.data||(t.data=null),m.push(t))},this.add_error=function(t,e){var s="llms-checkout-errors";$err=l("#"+s),$err.length||($err=l('<ul class="llms-notice llms-error" id="'+s+'" />'),l(".llms-checkout-wrapper").prepend($err)),$err.append("<li>"+t+"</li>"),e&&console.error(e)},this.add_gateway=function(t){s.push(t)},this.bind_coupon=function(){var e=this;l('a[href="#llms-coupon-toggle"]').on("click",function(t){t.preventDefault(),l(".llms-coupon-entry").slideToggle(400)}),l("#llms-apply-coupon").on("click",function(t){t.preventDefault(),e.coupon_apply(l(this))}),l("#llms-remove-coupon").on("click",function(t){t.preventDefault(),e.coupon_remove(l(this))})},this.bind_gateways=function(){this.load_gateways(),l('input[name="llms_payment_gateway"]').length||l("#llms_create_pending_order").removeAttr("disabled"),l('input[name="llms_payment_gateway"]').on("change",function(){l('input[name="llms_payment_gateway"]').each(function(){var t=l(this),e=t.closest(".llms-payment-gateway"),s=e.find(".llms-gateway-fields").find("input, textarea, select"),o=t.is(":checked");e[o?"addClass":"removeClass"]("is-selected"),o?(s.removeAttr("disabled"),l(".llms-payment-gateways").trigger("llms-gateway-selected",{id:t.val(),$selector:e})):s.attr("disabled","disabled")})}),l(".llms-payment-gateways").on("llms-gateway-selected",function(t,e){var s=l("#llms_create_pending_order");e.$selector&&e.$selector.find(".llms-gateway-fields .invalid").length?s.attr("disabled","disabled"):s.removeAttr("disabled")})},this.bind_login=function(){l('a[href="#llms-show-login"]').on("click",function(t){t.preventDefault(),l(this).closest(".llms-info").slideUp(400),l("form.llms-login").slideDown(400)})},this.clear_errors=function(){l("#llms-checkout-errors").remove()},this.coupon_apply=function(t){var s=this,e=l("#llms_coupon_code").val(),o=l(".llms-coupon-messages"),n=o.find(".llms-error"),i=l("form.llms-checkout");LLMS.Spinner.start(i),window.LLMS.Ajax.call({data:{action:"validate_coupon_code",code:e,plan_id:l("#llms-plan-id").val()},beforeSend:function(){n.hide()},success:function(t){if(LLMS.Spinner.stop(i),"error"===t.code){var e=l("<li>"+t.message+"</li>");n.length?n.empty():(n=l('<ul class="llms-notice llms-error" />'),o.append(n)),e.appendTo(n),n.show()}else t.success&&(l(".llms-coupon-wrapper").replaceWith(t.data.coupon_html),s.bind_coupon(),l(".llms-payment-gateways").replaceWith(t.data.gateways_html),s.bind_gateways(),l(".llms-order-summary").replaceWith(t.data.summary_html))}})},this.coupon_remove=function(t){var e=this,s=l("form.llms-checkout");LLMS.Spinner.start(s),window.LLMS.Ajax.call({data:{action:"remove_coupon_code",plan_id:l("#llms-plan-id").val()},success:function(t){LLMS.Spinner.stop(s),t.success&&(l(".llms-coupon-wrapper").replaceWith(t.data.coupon_html),e.bind_coupon(),l(".llms-order-summary").replaceWith(t.data.summary_html),l(".llms-payment-gateways").replaceWith(t.data.gateways_html),e.bind_gateways())}})},this.focus_errors=function(){l("html, body").animate({scrollTop:l("#llms-checkout-errors").offset().top-50},200)},this.load_gateways=function(){for(var t=0;t<=s.length;t++){var e=s[t];"object"==typeof e&&null!==e&&void 0!==e.bind&&"function"==typeof e.bind&&e.bind()}},this.processing=function(t){var e,s;switch(t){case"stop":e="removeClass";break;case"start":default:e="addClass"}"checkout"===this.form_action?s=this.$checkout_form:"confirm"===this.form_action&&(s=this.$confirm_form),s[e]("llms-is-processing"),LLMS.Spinner[t](this.$form_sections)},this.submit=function(t){var o,n=t.data,i=m.length,l=0,r=[],a=0,c=0;t.preventDefault(),n.processing("start"),n.clear_errors();for(var e=0;e<m.length;e++){var s=m[e];s.handler(s.data,function(t){a++,!0===t?c++:"string"==typeof t&&r.push(t)})}o=setInterval(function(){var t=!1,e=!1;if(6e4<=l)e=t=!0;else if(i===a)if(i===c)t=!0,n.$checkout_form.off("submit",n.submit),n.$checkout_form.trigger("submit");else if(r.length){e=t=!0;for(var s=0;s<r.length;s++)n.add_error(r[s]);n.focus_errors()}t&&clearInterval(o),e&&n.processing("stop"),l++},100)},this.init(),this}}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxsbXMtZm9ybS1jaGVja291dC5qcyJdLCJuYW1lcyI6WyIkIiwid2luZG93IiwibGxtcyIsImNoZWNrb3V0IiwiYmVmb3JlX3N1Ym1pdCIsImdhdGV3YXlzIiwidGhpcyIsIiRjaGVja291dF9mb3JtIiwiJGNvbmZpcm1fZm9ybSIsIiRmb3JtX3NlY3Rpb25zIiwiZm9ybV9hY3Rpb24iLCJpbml0Iiwic2VsZiIsImxlbmd0aCIsImZpbmQiLCJvbiIsInN1Ym1pdCIsImFkZF9iZWZvcmVfc3VibWl0X2V2ZW50IiwiZGF0YSIsIkxMTVMiLCJQYXNzd29yZFN0cmVuZ3RoIiwiaGFuZGxlciIsImJpbmRfbG9naW4iLCJiaW5kX2NvdXBvbiIsImJpbmRfZ2F0ZXdheXMiLCJwcm9jZXNzaW5nIiwib2JqIiwicHVzaCIsImFkZF9lcnJvciIsIm1lc3NhZ2UiLCJpZCIsIiRlcnIiLCJwcmVwZW5kIiwiYXBwZW5kIiwiY29uc29sZSIsImVycm9yIiwiYWRkX2dhdGV3YXkiLCJnYXRld2F5X2NsYXNzIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic2xpZGVUb2dnbGUiLCJjb3Vwb25fYXBwbHkiLCJjb3Vwb25fcmVtb3ZlIiwibG9hZF9nYXRld2F5cyIsInJlbW92ZUF0dHIiLCJlYWNoIiwiJGVsIiwiJHBhcmVudCIsImNsb3Nlc3QiLCIkZmllbGRzIiwiY2hlY2tlZCIsImlzIiwidHJpZ2dlciIsInZhbCIsIiRzZWxlY3RvciIsImF0dHIiLCIkc3VibWl0Iiwic2xpZGVVcCIsInNsaWRlRG93biIsImNsZWFyX2Vycm9ycyIsInJlbW92ZSIsIiRidG4iLCJjb2RlIiwiJG1lc3NhZ2VzIiwiJGVycm9ycyIsIiRjb250YWluZXIiLCJTcGlubmVyIiwic3RhcnQiLCJBamF4IiwiY2FsbCIsImFjdGlvbiIsInBsYW5faWQiLCJiZWZvcmVTZW5kIiwiaGlkZSIsInN1Y2Nlc3MiLCJyIiwic3RvcCIsIiRtZXNzYWdlIiwiZW1wdHkiLCJhcHBlbmRUbyIsInNob3ciLCJyZXBsYWNlV2l0aCIsImNvdXBvbl9odG1sIiwiZ2F0ZXdheXNfaHRtbCIsInN1bW1hcnlfaHRtbCIsImZvY3VzX2Vycm9ycyIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJ0b3AiLCJpIiwiZyIsInVuZGVmaW5lZCIsImJpbmQiLCJmdW5jIiwiJGZvcm0iLCJpbnRlcnZhbCIsIm51bSIsImNoZWNrcyIsImVycm9ycyIsImZpbmlzaGVzIiwic3VjY2Vzc2VzIiwic2V0SW50ZXJ2YWwiLCJjbGVhciIsIm9mZiIsImNsZWFySW50ZXJ2YWwiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJDQU1DLFNBQVlBLEdBaWlCWkMsT0FBT0MsS0FBT0QsT0FBT0MsTUFBUSxHQUM3QkQsT0FBT0MsS0FBS0MsU0FBVyxJQWhpQkgsV0FRbkIsSUFBSUMsRUFBZ0IsR0FRaEJDLEVBQVcsR0EyZ0JmLE9BemdCQUMsS0FBS0MsZUFBaUJQLEVBQUcsK0JBQ3pCTSxLQUFLRSxjQUFnQlIsRUFBRyx1Q0FDeEJNLEtBQUtHLGdCQUFpQixFQUN0QkgsS0FBS0ksYUFBYyxFQVFuQkosS0FBS0ssS0FBTyxXQUVYLElBQUlDLEVBQU9OLEtBRU5BLEtBQUtDLGVBQWVNLFFBRXhCUCxLQUFLSSxZQUFjLFdBQ25CSixLQUFLRyxlQUFpQkgsS0FBS0MsZUFBZU8sS0FBTSwwQkFFaERSLEtBQUtDLGVBQWVRLEdBQUksU0FBVVQsS0FBTUEsS0FBS1UsUUFHeENoQixFQUFHLGlDQUFrQ2EsUUFDekNQLEtBQUtXLHdCQUF5QixDQUM3QkMsS0FBTUMsS0FBS0MsaUJBQ1hDLFFBQVNGLEtBQUtDLGlCQUFpQmpCLFdBSWpDRyxLQUFLZ0IsYUFFTGhCLEtBQUtpQixjQUVMakIsS0FBS2tCLGlCQUVNbEIsS0FBS0UsY0FBY0ssU0FFOUJQLEtBQUtJLFlBQWMsVUFDbkJKLEtBQUtHLGVBQWlCSCxLQUFLRSxjQUFjTSxLQUFNLDBCQUUvQ1IsS0FBS0UsY0FBY08sR0FBSSxTQUFVLFdBQ2hDSCxFQUFLYSxXQUFZLGFBZ0JwQm5CLEtBQUtXLHdCQUEwQixTQUFV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LGNBQWVULEdBR1hwQixHQUNKaEUsRUFBS2EsV0FBWSxRQUlsQnlFLEtBRUUsTUFLSjVGLEtBQUtLLE9BRUVMLE1BN2hCUixDQW9pQklvRyIsImZpbGUiOiJsbG1zLWZvcm0tY2hlY2tvdXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBMaWZ0ZXJMTVMgQ2hlY2tvdXQgU2NyZWVuIHJlbGF0ZWQgZXZlbnRzIGFuZCBpbnRlcmFjdGlvbnNcbiAqXG4gKiBAc2luY2UgICAgMy4wLjBcbiAqIEB2ZXJzaW9uICAzLjI3LjBcbiAqL1xuOyggZnVuY3Rpb24oICQgKSB7XG5cblx0dmFyIGxsbXNfY2hlY2tvdXQgPSBmdW5jdGlvbigpIHtcblxuXHRcdC8qKlxuXHRcdCAqIEFycmF5IG9mIHZhbGlkYXRpb24gZnVuY3Rpb25zIHRvIGNhbGwgb24gZm9ybSBzdWJtaXNzaW9uXG5cdFx0ICogQHR5cGUgICAgYXJyYXlcblx0XHQgKiBAc2luY2UgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uIDMuMC4wXG5cdFx0ICovXG5cdFx0dmFyIGJlZm9yZV9zdWJtaXQgPSBbXTtcblxuXHRcdC8qKlxuXHRcdCAqIEFycmF5IG9mIGdhdGV3YXlzIHRvIGJlIGF1dG9tYXRpY2FsbHkgYm91bmQgd2hlbiBuZWVkZWRcblx0XHQgKiBAdHlwZSAgICBhcnJheVxuXHRcdCAqIEBzaW5jZSAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gMy4wLjBcblx0XHQgKi9cblx0XHR2YXIgZ2F0ZXdheXMgPSBbXTtcblxuXHRcdHRoaXMuJGNoZWNrb3V0X2Zvcm0gPSAkKCAnI2xsbXMtcHJvZHVjdC1wdXJjaGFzZS1mb3JtJyApO1xuXHRcdHRoaXMuJGNvbmZpcm1fZm9ybSA9ICQoICcjbGxtcy1wcm9kdWN0LXB1cmNoYXNlLWNvbmZpcm0tZm9ybScgKTtcblx0XHR0aGlzLiRmb3JtX3NlY3Rpb25zID0gZmFsc2U7XG5cdFx0dGhpcy5mb3JtX2FjdGlvbiA9IGZhbHNlO1xuXG5cdFx0LyoqXG5cdFx0ICogSW5pdGlhbGl6ZSBjaGVja291dCBKUyAmIGJpbmQgaWYgb24gdGhlIGNoZWNrb3V0IHNjcmVlblxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjQuMVxuXHRcdCAqL1xuXHRcdHRoaXMuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0XHRcdGlmICggdGhpcy4kY2hlY2tvdXRfZm9ybS5sZW5ndGggKSB7XG5cblx0XHRcdFx0dGhpcy5mb3JtX2FjdGlvbiA9ICdjaGVja291dCc7XG5cdFx0XHRcdHRoaXMuJGZvcm1fc2VjdGlvbnMgPSB0aGlzLiRjaGVja291dF9mb3JtLmZpbmQoICcubGxtcy1jaGVja291dC1zZWN0aW9uJyApO1xuXG5cdFx0XHRcdHRoaXMuJGNoZWNrb3V0X2Zvcm0ub24oICdzdWJtaXQnLCB0aGlzLCB0aGlzLnN1Ym1pdCApO1xuXG5cdFx0XHRcdC8vIGFkZCBiZWZvcmUgc3VibWl0IGV2ZW50IGZvciBwYXNzd29yZCBzdHJlbmd0aCBtZXRlciBpZiBvbmUncyBmb3VuZFxuXHRcdFx0XHRpZiAoICQoICcubGxtcy1wYXNzd29yZC1zdHJlbmd0aC1tZXRlcicgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0dGhpcy5hZGRfYmVmb3JlX3N1Ym1pdF9ldmVudCgge1xuXHRcdFx0XHRcdFx0ZGF0YTogTExNUy5QYXNzd29yZFN0cmVuZ3RoLFxuXHRcdFx0XHRcdFx0aGFuZGxlcjogTExNUy5QYXNzd29yZFN0cmVuZ3RoLmNoZWNrb3V0LFxuXHRcdFx0XHRcdH0gKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuYmluZF9sb2dpbigpO1xuXG5cdFx0XHRcdHRoaXMuYmluZF9jb3Vwb24oKTtcblxuXHRcdFx0XHR0aGlzLmJpbmRfZ2F0ZXdheXMoKTtcblxuXHRcdFx0fSBlbHNlIGlmICggdGhpcy4kY29uZmlybV9mb3JtLmxlbmd0aCApIHtcblxuXHRcdFx0XHR0aGlzLmZvcm1fYWN0aW9uID0gJ2NvbmZpcm0nO1xuXHRcdFx0XHR0aGlzLiRmb3JtX3NlY3Rpb25zID0gdGhpcy4kY29uZmlybV9mb3JtLmZpbmQoICcubGxtcy1jaGVja291dC1zZWN0aW9uJyApO1xuXG5cdFx0XHRcdHRoaXMuJGNvbmZpcm1fZm9ybS5vbiggJ3N1Ym1pdCcsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHNlbGYucHJvY2Vzc2luZyggJ3N0YXJ0JyApO1xuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBQdWJsaWMgZnVuY3Rpb24gd2hpY2ggYWxsb3dzIG90aGVyIGNsYXNzZXMgb3IgZXh0ZW5zaW9ucyB0byBhZGRcblx0XHQgKiBiZWZvcmUgc3VibWl0IGV2ZW50cyB0byBsbG1zIGNoZWNrb3V0IHByaXZhdGUgXCJiZWZvcmVfc3VibWl0XCIgYXJyYXlcblx0XHQgKiBAcGFyYW0gICAgb2JqZWN0ICBvYmogIG9iamVjdCBvZiBkYXRhIHRvIHB1c2ggdG8gdGhlIGFycmF5XG5cdFx0ICogICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlcyBhdCBsZWFzdCBhIFwiaGFuZGxlclwiIGtleSB3aGljaCBzaG91bGQgcGFzcyBhIGNhbGxhYmxlIGZ1bmN0aW9uXG5cdFx0ICogICAgICAgICAgICAgICAgICAgICAgICBcImRhdGFcIiBjYW4gYmUgYW55dGhpbmcsIHdpbGwgYmUgcGFzc2VkIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIgdG8gdGhlIGhhbmRsZXIgZnVuY3Rpb25cblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmFkZF9iZWZvcmVfc3VibWl0X2V2ZW50ID0gZnVuY3Rpb24oIG9iaiApIHtcblxuXHRcdFx0aWYgKCAhb2JqLmhhbmRsZXIgfHwgJ2Z1bmN0aW9uJyAhPT0gdHlwZW9mIG9iai5oYW5kbGVyICkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGlmICggIW9iai5kYXRhICkge1xuXHRcdFx0XHRvYmouZGF0YSA9IG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGJlZm9yZV9zdWJtaXQucHVzaCggb2JqICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQWRkIGFuIGVycm9yIG1lc3NhZ2Vcblx0XHQgKiBAcGFyYW0gICAgc3RyaW5nICAgICBtZXNzYWdlICBlcnJvciBtZXNzYWdlIHN0cmluZ1xuXHRcdCAqIEBwYXJhbSAgICBtaXhlZCAgICAgIGRhdGEgICAgIG9wdGlvbmFsIGVycm9yIGRhdGEgdG8gb3V0cHV0IG9uIHRoZSBjb25zb2xlXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4yNy4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjcuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYWRkX2Vycm9yID0gZnVuY3Rpb24oIG1lc3NhZ2UsIGRhdGEgKSB7XG5cblx0XHRcdHZhciBpZCA9ICdsbG1zLWNoZWNrb3V0LWVycm9ycyc7XG5cdFx0XHRcdCRlcnIgPSAkKCAnIycgKyBpZCApO1xuXG5cdFx0XHRpZiAoICEgJGVyci5sZW5ndGggKSB7XG5cdFx0XHRcdCRlcnIgPSAkKCAnPHVsIGNsYXNzPVwibGxtcy1ub3RpY2UgbGxtcy1lcnJvclwiIGlkPVwiJyArIGlkICsgJ1wiIC8+JyApO1xuXHRcdFx0XHQkKCAnLmxsbXMtY2hlY2tvdXQtd3JhcHBlcicgKS5wcmVwZW5kKCAkZXJyICk7XG5cdFx0XHR9XG5cblx0XHRcdCRlcnIuYXBwZW5kKCAnPGxpPicgKyBtZXNzYWdlICsgJzwvbGk+JyApO1xuXG5cdFx0XHRpZiAoIGRhdGEgKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoIGRhdGEgKTtcblx0XHRcdH1cblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBQdWJsaWMgZnVuY3Rpb24gd2hpY2ggYWxsb3dzIG90aGVyIGNsYXNzZXMgb3IgZXh0ZW5zaW9ucyB0byBhZGRcblx0XHQgKiBnYXRld2F5cyBjbGFzc2VzIHRoYXQgc2hvdWxkIGJlIGJvdW5kIGJ5IHRoaXMgY2xhc3Ncblx0XHQgKiBAcGFyYW0gICAgb2JqICAgZ2F0ZXdheV9jbGFzcyAgY2FsbGFibGUgY2xhc3Mgb2JqZWN0XG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMC4wXG5cdFx0ICovXG5cdFx0dGhpcy5hZGRfZ2F0ZXdheSA9IGZ1bmN0aW9uKCBnYXRld2F5X2NsYXNzICkge1xuXG5cdFx0XHRnYXRld2F5cy5wdXNoKCBnYXRld2F5X2NsYXNzICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBjb3Vwb24gYWRkICYgcmVtb3ZlIGJ1dHRvbiBldmVudHNcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYmluZF9jb3Vwb24gPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHQvLyBzaG93ICYgaGlkZSB0aGUgY291cG9uIGZpZWxkICYgYnV0dG9uXG5cdFx0XHQkKCAnYVtocmVmPVwiI2xsbXMtY291cG9uLXRvZ2dsZVwiXScgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQkKCAnLmxsbXMtY291cG9uLWVudHJ5JyApLnNsaWRlVG9nZ2xlKCA0MDAgKTtcblxuXHRcdFx0fSApO1xuXG5cdFx0XHQvLyBhcHBseSBjb3Vwb24gY2xpY2tcblx0XHRcdCQoICcjbGxtcy1hcHBseS1jb3Vwb24nICkub24oICdjbGljaycsIGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0c2VsZi5jb3Vwb25fYXBwbHkoICQoIHRoaXMgKSApO1xuXG5cdFx0XHR9ICk7XG5cblx0XHRcdC8vIHJlbW92ZSBjb3Vwb24gY2xpY2tcblx0XHRcdCQoICcjbGxtcy1yZW1vdmUtY291cG9uJyApLm9uKCAnY2xpY2snLCBmdW5jdGlvbiggZSApIHtcblxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHNlbGYuY291cG9uX3JlbW92ZSggJCggdGhpcyApICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBCaW5kIGdhdGV3YXkgc2VjdGlvbiBldmVudHNcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYmluZF9nYXRld2F5cyA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHR0aGlzLmxvYWRfZ2F0ZXdheXMoKTtcblxuXHRcdFx0aWYgKCAhICQoICdpbnB1dFtuYW1lPVwibGxtc19wYXltZW50X2dhdGV3YXlcIl0nKS5sZW5ndGggKSB7XG5cdFx0XHRcdCQoICcjbGxtc19jcmVhdGVfcGVuZGluZ19vcmRlcicgKS5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIGFkZCBjbGFzcyBhbmQgdHJpZ2dlciB3YXRjaGFibGUgZXZlbnQgd2hlbiBnYXRld2F5IHNlbGVjdGlvbiBjaGFuZ2VzXG5cdFx0XHQkKCAnaW5wdXRbbmFtZT1cImxsbXNfcGF5bWVudF9nYXRld2F5XCJdJyApLm9uKCAnY2hhbmdlJywgZnVuY3Rpb24oKSB7XG5cbiBcdFx0XHRcdCQoICdpbnB1dFtuYW1lPVwibGxtc19wYXltZW50X2dhdGV3YXlcIl0nICkuZWFjaCggZnVuY3Rpb24oKSB7XG5cblx0XHRcdFx0XHR2YXIgJGVsID0gJCggdGhpcyApLFxuXHRcdFx0XHRcdFx0JHBhcmVudCA9ICRlbC5jbG9zZXN0KCAnLmxsbXMtcGF5bWVudC1nYXRld2F5JyApLFxuXHRcdFx0XHRcdFx0JGZpZWxkcyA9ICRwYXJlbnQuZmluZCggJy5sbG1zLWdhdGV3YXktZmllbGRzJyApLmZpbmQoICdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCcgKSxcblx0XHRcdFx0XHRcdGNoZWNrZWQgPSAkZWwuaXMoICc6Y2hlY2tlZCcgKSxcblx0XHRcdFx0XHRcdGRpc3BsYXlfZnVuYyA9ICggY2hlY2tlZCApID8gJ2FkZENsYXNzJyA6ICdyZW1vdmVDbGFzcyc7XG5cblx0XHRcdFx0XHQkcGFyZW50WyBkaXNwbGF5X2Z1bmMgXSggJ2lzLXNlbGVjdGVkJyApO1xuXG5cdFx0XHRcdFx0aWYgKCBjaGVja2VkICkge1xuXG5cdFx0XHRcdFx0XHQvLyBlbmFibGUgZmllbGRzXG5cdFx0XHRcdFx0XHQkZmllbGRzLnJlbW92ZUF0dHIoICdkaXNhYmxlZCcgKTtcblxuXHRcdFx0XHRcdFx0Ly8gZW1pdCBhIHdhdGNoYWJsZSBldmVudCBmb3IgZXh0ZW5zaW9ucyB0byBob29rIG9udG9cblx0XHRcdFx0XHRcdCQoICcubGxtcy1wYXltZW50LWdhdGV3YXlzJyApLnRyaWdnZXIoICdsbG1zLWdhdGV3YXktc2VsZWN0ZWQnLCB7XG5cdFx0XHRcdFx0XHRcdGlkOiAkZWwudmFsKCksXG5cdFx0XHRcdFx0XHRcdCRzZWxlY3RvcjogJHBhcmVudCxcblx0XHRcdFx0XHRcdH0gKTtcblxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRcdC8vIGRpc2FibGUgZmllbGRzXG5cdFx0XHRcdFx0XHQkZmllbGRzLmF0dHIoICdkaXNhYmxlZCcsICdkaXNhYmxlZCcgKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH0gKTtcblxuXHRcdFx0Ly8gZW5hYmxlIC8gZGlzYWJsZSBidXR0b25zIGRlcGVuZGluZyBvbiBmaWVsZCB2YWxpZGF0aW9uIHN0YXR1c1xuXHRcdFx0JCggJy5sbG1zLXBheW1lbnQtZ2F0ZXdheXMnICkub24oICdsbG1zLWdhdGV3YXktc2VsZWN0ZWQnLCBmdW5jdGlvbiggZSwgZGF0YSApIHtcblxuXHRcdFx0XHR2YXIgJHN1Ym1pdCA9ICQoICcjbGxtc19jcmVhdGVfcGVuZGluZ19vcmRlcicgKTtcblxuXHRcdFx0XHRpZiAoIGRhdGEuJHNlbGVjdG9yICYmIGRhdGEuJHNlbGVjdG9yLmZpbmQoICcubGxtcy1nYXRld2F5LWZpZWxkcyAuaW52YWxpZCcgKS5sZW5ndGggKSB7XG5cdFx0XHRcdFx0JHN1Ym1pdC5hdHRyKCAnZGlzYWJsZWQnLCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0JHN1Ym1pdC5yZW1vdmVBdHRyKCAnZGlzYWJsZWQnICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIEJpbmQgY2xpY2sgZXZlbnRzIGZvciB0aGUgU2hvdyAvIEhpZGUgbG9naW4gYXJlYSBhdCB0aGUgdG9wIG9mIHRoZSBjaGVja291dCBzY3JlZW5cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuYmluZF9sb2dpbiA9IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHQkKCAnYVtocmVmPVwiI2xsbXMtc2hvdy1sb2dpblwiXScgKS5vbiggJ2NsaWNrJywgZnVuY3Rpb24oIGUgKSB7XG5cblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHQkKCB0aGlzICkuY2xvc2VzdCggJy5sbG1zLWluZm8nICkuc2xpZGVVcCggNDAwICk7XG5cdFx0XHRcdCQoICdmb3JtLmxsbXMtbG9naW4nICkuc2xpZGVEb3duKCA0MDAgKTtcblxuXHRcdFx0fSApO1xuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBDbGVhciBlcnJvciBtZXNzYWdlc1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMjcuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI3LjBcblx0XHQgKi9cblx0XHR0aGlzLmNsZWFyX2Vycm9ycyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0JCggJyNsbG1zLWNoZWNrb3V0LWVycm9ycycgKS5yZW1vdmUoKTtcblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogVHJpZ2dlcmVkIGJ5IGNsaWNraW5nIHRoZSBcIkFwcGx5IENvdXBvblwiIEJ1dHRvblxuXHRcdCAqIFZhbGlkYXRlcyB0aGUgY291cG9uIHZpYSBKUyBhbmQgYWRkcyBlcnJvciAvIHN1Y2Nlc3MgbWVzc2FnZXNcblx0XHQgKiBPbiBzdWNjZXNzIGl0IHdpbGwgcmVwbGFjZSBwYXJ0aWFscyBvbiB0aGUgY2hlY2tvdXQgc2NyZWVuIHdpdGggdXBkYXRlZFxuXHRcdCAqIHByaWNlcyBhbmQgYSBcInJlbW92ZSBjb3Vwb25cIiBidXR0b25cblx0XHQgKiBAcGFyYW0gICAgb2JqICAgJGJ0biAgalF1ZXJ5IHNlbGVjdG9yIG9mIHRoZSBBcHBseSBidXR0b25cblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjAuMFxuXHRcdCAqL1xuXHRcdHRoaXMuY291cG9uX2FwcGx5ID0gZnVuY3Rpb24gKCAkYnRuICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IHRoaXMsXG5cdFx0XHRcdCRjb2RlID0gJCggJyNsbG1zX2NvdXBvbl9jb2RlJyApLFxuXHRcdFx0XHRjb2RlID0gJGNvZGUudmFsKCksXG5cdFx0XHRcdCRtZXNzYWdlcyA9ICQoICcubGxtcy1jb3Vwb24tbWVzc2FnZXMnICksXG5cdFx0XHRcdCRlcnJvcnMgPSAkbWVzc2FnZXMuZmluZCggJy5sbG1zLWVycm9yJyApLFxuXHRcdFx0XHQkY29udGFpbmVyID0gJCggJ2Zvcm0ubGxtcy1jaGVja291dCcgKTtcblxuXHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkY29udGFpbmVyICk7XG5cblx0XHRcdHdpbmRvdy5MTE1TLkFqYXguY2FsbCgge1xuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAndmFsaWRhdGVfY291cG9uX2NvZGUnLFxuXHRcdFx0XHRcdGNvZGU6IGNvZGUsXG5cdFx0XHRcdFx0cGxhbl9pZDogJCggJyNsbG1zLXBsYW4taWQnICkudmFsKCksXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0JGVycm9ycy5oaWRlKCk7XG5cblx0XHRcdFx0fSxcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIHIgKSB7XG5cblx0XHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJGNvbnRhaW5lciApO1xuXG5cdFx0XHRcdFx0aWYgKCAnZXJyb3InID09PSByLmNvZGUgKSB7XG5cblx0XHRcdFx0XHRcdHZhciAkbWVzc2FnZSA9ICQoICc8bGk+JyArIHIubWVzc2FnZSArICc8L2xpPicpO1xuXG5cdFx0XHRcdFx0XHRpZiAoICEgJGVycm9ycy5sZW5ndGggKSB7XG5cblx0XHRcdFx0XHRcdFx0JGVycm9ycyA9ICQoICc8dWwgY2xhc3M9XCJsbG1zLW5vdGljZSBsbG1zLWVycm9yXCIgLz4nICk7XG5cdFx0XHRcdFx0XHRcdCRtZXNzYWdlcy5hcHBlbmQoICRlcnJvcnMgKTtcblxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHQkZXJyb3JzLmVtcHR5KCk7XG5cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0JG1lc3NhZ2UuYXBwZW5kVG8oICRlcnJvcnMgKTtcblx0XHRcdFx0XHRcdCRlcnJvcnMuc2hvdygpO1xuXG5cdFx0XHRcdFx0fSBlbHNlIGlmICggci5zdWNjZXNzICkge1xuXG5cdFx0XHRcdFx0XHQkKCAnLmxsbXMtY291cG9uLXdyYXBwZXInICkucmVwbGFjZVdpdGgoIHIuZGF0YS5jb3Vwb25faHRtbCApO1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kX2NvdXBvbigpO1xuXG5cdFx0XHRcdFx0XHQkKCAnLmxsbXMtcGF5bWVudC1nYXRld2F5cycgKS5yZXBsYWNlV2l0aCggci5kYXRhLmdhdGV3YXlzX2h0bWwgKTtcblx0XHRcdFx0XHRcdHNlbGYuYmluZF9nYXRld2F5cygpO1xuXG5cdFx0XHRcdFx0XHQkKCAnLmxsbXMtb3JkZXItc3VtbWFyeScgKS5yZXBsYWNlV2l0aCggci5kYXRhLnN1bW1hcnlfaHRtbCApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0fSApO1xuXG5cdFx0fTtcblxuXHRcdC8qKlxuXHRcdCAqIENhbGxlZCBieSBjbGlja2luZyB0aGUgXCJSZW1vdmUgQ291cG9uXCIgYnV0dG9uXG5cdFx0ICogUmVtb3ZlcyB0aGUgY291cG9uIHZpYSBBSkFYIGFuZCB1bnNldHMgcmVsYXRlZCBzZXNzaW9uIGRhdGFcblx0XHQgKiBAcGFyYW0gICAgb2JqICAgJGJ0biAgalF1ZXJ5IHNlbGVjdG9yIG9mIHRoZSBSZW1vdmUgYnV0dG9uXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmNvdXBvbl9yZW1vdmUgPSBmdW5jdGlvbiggJGJ0biApIHtcblxuXHRcdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0XHQkY29udGFpbmVyID0gJCggJ2Zvcm0ubGxtcy1jaGVja291dCcgKTtcblxuXHRcdFx0TExNUy5TcGlubmVyLnN0YXJ0KCAkY29udGFpbmVyICk7XG5cblx0XHRcdHdpbmRvdy5MTE1TLkFqYXguY2FsbCgge1xuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0YWN0aW9uOiAncmVtb3ZlX2NvdXBvbl9jb2RlJyxcblx0XHRcdFx0XHRwbGFuX2lkOiAkKCAnI2xsbXMtcGxhbi1pZCcgKS52YWwoKSxcblx0XHRcdFx0fSxcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oIHIgKSB7XG5cblx0XHRcdFx0XHRMTE1TLlNwaW5uZXIuc3RvcCggJGNvbnRhaW5lciApO1xuXG5cdFx0XHRcdFx0aWYgKCByLnN1Y2Nlc3MgKSB7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1jb3Vwb24td3JhcHBlcicgKS5yZXBsYWNlV2l0aCggci5kYXRhLmNvdXBvbl9odG1sICk7XG5cdFx0XHRcdFx0XHRzZWxmLmJpbmRfY291cG9uKCk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1vcmRlci1zdW1tYXJ5JyApLnJlcGxhY2VXaXRoKCByLmRhdGEuc3VtbWFyeV9odG1sICk7XG5cblx0XHRcdFx0XHRcdCQoICcubGxtcy1wYXltZW50LWdhdGV3YXlzJyApLnJlcGxhY2VXaXRoKCByLmRhdGEuZ2F0ZXdheXNfaHRtbCApO1xuXHRcdFx0XHRcdFx0c2VsZi5iaW5kX2dhdGV3YXlzKCk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9ICk7XG5cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogU2Nyb2xsIGVycm9yIG1lc3NhZ2VzIGludG8gdmlld1xuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMjcuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI3LjBcblx0XHQgKi9cblx0XHR0aGlzLmZvY3VzX2Vycm9ycyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0JCggJ2h0bWwsIGJvZHknICkuYW5pbWF0ZSgge1xuXHRcdFx0XHRzY3JvbGxUb3A6ICQoICcjbGxtcy1jaGVja291dC1lcnJvcnMnICkub2Zmc2V0KCkudG9wIC0gNTAsXG5cdFx0XHR9LCAyMDAgKTtcblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogQmluZCBleHRlcm5hbCBnYXRld2F5IEpTXG5cdFx0ICogQHJldHVybiAgIHZvaWRcblx0XHQgKiBAc2luY2UgICAgMy4wLjBcblx0XHQgKiBAdmVyc2lvbiAgMy4wLjBcblx0XHQgKi9cblx0XHR0aGlzLmxvYWRfZ2F0ZXdheXMgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0Zm9yICggdmFyIGkgPSAwOyBpIDw9IGdhdGV3YXlzLmxlbmd0aDsgaSsrICkge1xuXHRcdFx0XHR2YXIgZyA9IGdhdGV3YXlzW2ldO1xuXHRcdFx0XHRpZiAoIHR5cGVvZiBnID09PSAnb2JqZWN0JyAmJiBnICE9PSBudWxsICkge1xuXHRcdFx0XHRcdGlmICggZy5iaW5kICE9PSB1bmRlZmluZWQgJiYgJ2Z1bmN0aW9uJyA9PT0gdHlwZW9mIGcuYmluZCAgKSB7XG5cdFx0XHRcdFx0XHRnLmJpbmQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0LyoqXG5cdFx0ICogU3RhcnQgb3Igc3RvcCBwcm9jZXNzaW5nIGV2ZW50cyBvbiB0aGUgY2hlY2tvdXQgZm9ybVxuXHRcdCAqIEBwYXJhbSAgICBzdHJpbmcgICBhY3Rpb24gIHdoZXRoZXIgdG8gc3RhcnQgb3Igc3RvcCBwcm9jZXNzaW5nIFtzdGFydHxzdG9wXVxuXHRcdCAqIEByZXR1cm4gICB2b2lkXG5cdFx0ICogQHNpbmNlICAgIDMuMC4wXG5cdFx0ICogQHZlcnNpb24gIDMuMjQuMVxuXHRcdCAqL1xuXHRcdHRoaXMucHJvY2Vzc2luZyA9IGZ1bmN0aW9uKCBhY3Rpb24gKSB7XG5cblx0XHRcdHZhciBmdW5jLCAkZm9ybTtcblxuXHRcdFx0c3dpdGNoICggYWN0aW9uICkge1xuXG5cdFx0XHRcdGNhc2UgJ3N0b3AnOlxuXHRcdFx0XHRcdGZ1bmMgPSAncmVtb3ZlQ2xhc3MnO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdzdGFydCc6XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0ZnVuYyA9ICdhZGRDbGFzcyc7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggJ2NoZWNrb3V0JyA9PT0gdGhpcy5mb3JtX2FjdGlvbiApIHtcblx0XHRcdFx0JGZvcm0gPSB0aGlzLiRjaGVja291dF9mb3JtO1xuXHRcdFx0fSBlbHNlIGlmICggJ2NvbmZpcm0nID09PSB0aGlzLmZvcm1fYWN0aW9uICkge1xuXHRcdFx0XHQkZm9ybSA9IHRoaXMuJGNvbmZpcm1fZm9ybTtcblx0XHRcdH1cblxuXHRcdFx0JGZvcm1bIGZ1bmMgXSggJ2xsbXMtaXMtcHJvY2Vzc2luZycgKTtcblx0XHRcdExMTVMuU3Bpbm5lclsgYWN0aW9uIF0oIHRoaXMuJGZvcm1fc2VjdGlvbnMgKTtcblxuXHRcdH07XG5cblx0XHQvKipcblx0XHQgKiBIYW5kbGVzIGZvcm0gc3VibWlzc2lvblxuXHRcdCAqIENhbGxzIGFsbCB2YWxpZGF0aW9uIGV2ZW50cyBpbiBgYmVmb3JlX3N1Ym1pdFtdYFxuXHRcdCAqIHdhaXRzIGZvciBjYWxsIGJhY2tzIGFuZCBlaXRoZXIgZGlzcGxheXMgcmV0dXJuZWQgZXJyb3JzXG5cdFx0ICogb3Igc3VibWl0cyB0aGUgZm9ybSB3aGVuIGFsbCBhcmUgc3VjY2Vzc2Z1bFxuXHRcdCAqIEBwYXJhbSAgICBvYmogICBlICBKUyBldmVudCBvYmplY3Rcblx0XHQgKiBAcmV0dXJuICAgdm9pZFxuXHRcdCAqIEBzaW5jZSAgICAzLjAuMFxuXHRcdCAqIEB2ZXJzaW9uICAzLjI3LjBcblx0XHQgKi9cblx0XHR0aGlzLnN1Ym1pdCA9IGZ1bmN0aW9uKCBlICkge1xuXG5cdFx0XHR2YXIgc2VsZiA9IGUuZGF0YSxcblx0XHRcdFx0bnVtID0gYmVmb3JlX3N1Ym1pdC5sZW5ndGgsXG5cdFx0XHRcdGNoZWNrcyA9IDAsXG5cdFx0XHRcdG1heF9jaGVja3MgPSA2MDAwMCxcblx0XHRcdFx0ZXJyb3JzID0gW10sXG5cdFx0XHRcdGZpbmlzaGVzID0gMCxcblx0XHRcdFx0c3VjY2Vzc2VzID0gMCxcblx0XHRcdFx0aW50ZXJ2YWw7XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0Ly8gYWRkIHNwaW5uZXJzXG5cdFx0XHRzZWxmLnByb2Nlc3NpbmcoICdzdGFydCcgKTtcblxuXHRcdFx0Ly8gcmVtb3ZlIGVycm9ycyB0byBwcmV2ZW50IGR1cGxpY2F0ZXNcblx0XHRcdHNlbGYuY2xlYXJfZXJyb3JzKCk7XG5cblx0XHRcdC8vIHN0YXJ0IHJ1bm5pbmcgYWxsIHRoZSBldmVudHNcblx0XHRcdGZvciAoIHZhciBpID0gMDsgaSA8IGJlZm9yZV9zdWJtaXQubGVuZ3RoOyBpKysgKSB7XG5cblx0XHRcdFx0dmFyIG9iaiA9IGJlZm9yZV9zdWJtaXRbIGkgXTtcblxuXHRcdFx0XHRvYmouaGFuZGxlciggb2JqLmRhdGEsIGZ1bmN0aW9uKCByICkge1xuXG5cdFx0XHRcdFx0ZmluaXNoZXMrKztcblx0XHRcdFx0XHRpZiAoIHRydWUgPT09IHIgKSB7XG5cdFx0XHRcdFx0XHRzdWNjZXNzZXMrKztcblx0XHRcdFx0XHR9IGVsc2UgaWYgKCAnc3RyaW5nJyA9PT0gdHlwZW9mIHIgKSB7XG5cdFx0XHRcdFx0XHRlcnJvcnMucHVzaCggciApO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gcnVuIGFuIGludGVydmFsIHRvIHdhaXQgZm9yIGZpbmlzaGVzXG5cdFx0XHRpbnRlcnZhbCA9IHNldEludGVydmFsKCBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHR2YXIgY2xlYXIgPSBmYWxzZSxcblx0XHRcdFx0XHRzdG9wID0gZmFsc2U7XG5cblx0XHRcdFx0Ly8gdGltZW91dC4uLlxuXHRcdFx0XHRpZiAoIGNoZWNrcyA+PSBtYXhfY2hlY2tzICkge1xuXG5cdFx0XHRcdFx0Y2xlYXIgPSB0cnVlO1xuXHRcdFx0XHRcdHN0b3AgPSB0cnVlO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gZXZlcnl0aGluZyBoYXMgZmluaXNoZWRcblx0XHRcdFx0ZWxzZSBpZiAoIG51bSA9PT0gZmluaXNoZXMgKSB7XG5cblx0XHRcdFx0XHQvLyBhbGwgd2VyZSBzdWNjZXNzZnVsLCBzdWJtaXQgdGhlIGZvcm1cblx0XHRcdFx0XHRpZiAoIG51bSA9PT0gc3VjY2Vzc2VzICkge1xuXG5cdFx0XHRcdFx0XHRjbGVhciA9IHRydWU7XG5cblx0XHRcdFx0XHRcdHNlbGYuJGNoZWNrb3V0X2Zvcm0ub2ZmKCAnc3VibWl0Jywgc2VsZi5zdWJtaXQgKTtcblx0XHRcdFx0XHRcdHNlbGYuJGNoZWNrb3V0X2Zvcm0udHJpZ2dlciggJ3N1Ym1pdCcgKTtcblxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIGVycm9ycy5sZW5ndGggKSB7XG5cblx0XHRcdFx0XHRcdGNsZWFyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHN0b3AgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCBlcnJvcnMubGVuZ3RoOyBpKysgKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYuYWRkX2Vycm9yKCBlcnJvcnNbIGkgXSApO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRzZWxmLmZvY3VzX2Vycm9ycygpO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIGNsZWFyICkge1xuXHRcdFx0XHRcdGNsZWFySW50ZXJ2YWwoIGludGVydmFsICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIHN0b3AgKSB7XG5cdFx0XHRcdFx0c2VsZi5wcm9jZXNzaW5nKCAnc3RvcCcgKTtcblx0XHRcdFx0fVxuXG5cblx0XHRcdFx0Y2hlY2tzKys7XG5cblx0XHRcdH0sIDEwMCApO1xuXG5cdFx0fTtcblxuXHRcdC8vIGluaXRpYWxpemVcblx0XHR0aGlzLmluaXQoKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH07XG5cblx0d2luZG93LmxsbXMgPSB3aW5kb3cubGxtcyB8fCB7fTtcblx0d2luZG93LmxsbXMuY2hlY2tvdXQgPSBuZXcgbGxtc19jaGVja291dCgpO1xuXG59ICkoIGpRdWVyeSApO1xuIl19
